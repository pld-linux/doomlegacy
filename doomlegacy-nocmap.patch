--- doomlegacy-1.40/doomlegacy_142_src/linux_x/i_video_xshm.c.orig	Fri Mar  7 22:22:56 2003
+++ doomlegacy-1.40/doomlegacy_142_src/linux_x/i_video_xshm.c	Fri Mar  7 22:51:25 2003
@@ -1619,14 +1619,14 @@
     if(rendermode==render_soft) {
     // setup attributes for main window
     if (vidmode_active) {
-       attribmask = CWColormap | CWSaveUnder | CWBackingStore | 
+       attribmask = CWSaveUnder | CWBackingStore | 
           CWEventMask | CWOverrideRedirect;
 
        attribs.override_redirect = True;
        attribs.backing_store = NotUseful;
        attribs.save_under = False;
     } else
-       attribmask = CWBorderPixel | CWColormap | CWEventMask;
+       attribmask = CWBorderPixel | CWEventMask;
 
     attribs.event_mask = KeyPressMask | KeyReleaseMask
 #ifndef POLL_POINTER
@@ -1634,7 +1634,10 @@
 #endif
        | ExposureMask | StructureNotifyMask;
     
+    if( x_pseudo ) {
+    attribmask |= CWColormap;
     attribs.colormap = X_cmap;
+    }
     attribs.border_pixel = 0;
     
     // create the main window
